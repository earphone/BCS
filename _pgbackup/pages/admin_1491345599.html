<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <meta name="description" content=""> 
        <meta name="author" content=""> 
        <title>BCS Webapp Admin</title>         
        <!-- Bootstrap Core CSS -->         
        <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"> 
        <!-- MetisMenu CSS -->         
        <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet"> 
        <!-- Custom CSS -->         
        <link href="../dist/css/sb-admin-2.css" rel="stylesheet"> 
        <!-- Custom Fonts -->         
        <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"> 
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->         
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->         
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->         
    </head>     
    <body onload="checkUser()"> 
        <div id="wrapper"> 
            <!-- Navigation -->             
            <!-- Page Content -->             
            <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0"> 
                <div class="navbar-header"> 
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> 
                        <span class="sr-only">Toggle navigation</span> 
                        <span class="icon-bar"></span> 
                        <span class="icon-bar"></span> 
                        <span class="icon-bar"></span> 
                    </button>                     
                    <a class="navbar-brand" href="index.html"><b>BCS Webapp</b></a> 
                </div>                 
                <!-- /.navbar-header -->                 
                <!-- /.navbar-top-links -->                 
                <div class="navbar-default sidebar" role="navigation"> 
                    <div class="sidebar-nav navbar-collapse"> 
                        <ul class="nav" id="side-menu"> 
                            <li> 
                                <a href="index.html"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a> 
                            </li>                             
                            <li> 
                                <a href="dpr.html"><i class="fa fa-list-alt fa-fw"></i> DPR</a> 
                            </li>                             
                            <li> 
                                <a href="dtr.html"><i class="fa fa-list fa-fw"></i> DTR</a> 
                            </li>                             
                            <li> 
                                <a href="profile.html"><i class="fa fa-user fa-fw"></i>&nbsp;Profile</a> 
                            </li>                             
                            <li> 
                                <a href="admin.html"><i class="fa fa-gamepad fa-fw"></i> Admin</a> 
                            </li>                             
                            <!-- fa-institution -->                             
                            <li> 
                                <a href="login.html" id="logout" onclick="logoutUser()"><i class="fa fa-sign-out fa-fw"></i> Logout</a> 
                            </li>                             
                        </ul>                         
                    </div>                     
                    <!-- /.sidebar-collapse -->                     
                </div>                 
                <!-- /.navbar-static-side -->                 
            </nav>
            <div id="page-wrapper"> 
                <div class="container-fluid"> 
                    <div class="row"> 
                        <div class="col-lg-12"> 
                            <h1 class="page-header">Admin</h1> 
                            <p><button type="button" class="btn btn-primary btn-lg btn-block" onclick="listDPR()">View DPRs</button></p>
                            <p><button type="button" class="btn btn-primary btn-lg btn-block" onclick="listDTR()">View DTRs</button></p>
                            <p><button type="button" class="btn btn-primary btn-lg btn-block" onclick="listEmployees()">View Employees</button></p>
                            <hr>
                        </div>
                        <!-- /.col-lg-12 -->
                    </div>
                    <!-- /.row -->
                    <div class="row"> 
                        <div class="col-lg-12" id="data-list"> 
</div>
                    </div>
                    <hr>
                    <div class="row"> 
                        <div class="col-lg-12" id="data-view"> 
</div>
                    </div>
                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- /#page-wrapper -->
        </div>         
        <!-- /#wrapper -->         
        <!-- Firebase Initialization -->         
        <script src="https://www.gstatic.com/firebasejs/3.7.0/firebase.js"></script>         
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyA55RJ8kvG-n-UClBQSNjnjLK3dvb1vwd8",
                authDomain: "bcs-webapp.firebaseapp.com",
                databaseURL: "https://bcs-webapp.firebaseio.com",
                storageBucket: "bcs-webapp.appspot.com",
                messagingSenderId: "664106049370"
            };
            firebase.initializeApp(config);
        </script>         
        <!-- Firebase Create User -->         
        <script>
        function logoutUser() {
            firebase.auth().signOut().then(function() {
              console.log('Signed Out');
            }, function(error) {
              console.error('Sign Out Error', error);
            });
        }
        </script>         
        <!-- Checks if user is logged in. If not,  redirects to Login page -->
        <script>
        function checkUser() {
            console.log("Checking User!");
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    console.log(user.uid + " is signed in");
                    // User is signed in.
                } else {
                    // No user is signed in.
                    window.location="login.html";
                }
            });
        }
        </script>
        <script>
        function listDPR() {
            // Clear list and view divs
            var dataList = document.getElementById("data-list");
            var dataView = document.getElementById("data-view");
            dataList.innerHTML = "";
            dataView.innerHTML = "";
        }
        </script>
        <script>
        function listDTR() {
            // Clear list and view divs
            var dataList = document.getElementById("data-list");
            var dataView = document.getElementById("data-view");
            dataList.innerHTML = "";
            dataView.innerHTML = "";
        }
        </script>
        <script>
        function listEmployees() {
            // Clear list and view divs
            var dataList = document.getElementById("data-list");
            var dataView = document.getElementById("data-view");
            dataList.innerHTML = "";
            dataView.innerHTML = "";
            var query = firebase.database().ref("employees/employed/").orderByChild("nameFull");
                query.once("value")
                    .then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot) {
                        var listEmployee = document.createElement("a");
                        listEmployee.text = childSnapshot.val().nameFull;
                        listEmployee.className = "list-group-item";
                        listEmployee.href = "javascript:void(0)";
                        listEmployee.onclick = function showData() {
                            var dataFirst = childSnapshot.val().nameFirst;
                            var dataLast = childSnapshot.val().nameLast;
                            var dataInitials = childSnapshot.val().initials;
                            var dataID = childSnapshot.val().idNum;
                            var dataCell = childSnapshot.val().cellNum;
                            var dataContact = childSnapshot.val().contactNum;
                            var dataCompany = childSnapshot.val().company;
                            var dataJourneyman = childSnapshot.val().journeyman;
                            var dataApprentice = childSnapshot.val().apprentice;
                            var dataStep = childSnapshot.val().step;
                            for(var i = 0; i<6; i++) {
                                var tempLabel = document.createElement("h5");
                                var tempElement = document.createElement("input");
                                // switch statement to easily set up each field
                                switch(i) {
                                    case 0:
                                		tempLabel.textContent = "First Name";	
                                		tempElement.value = dataFirst;
                                        tempElement.placeHolder = dataFirst;
                                        break
                                    case 1:
                                		tempLabel.textContent = "Last Name";	
                                		tempElement.value = dataLast;
                                        tempElement.placeHolder = dataLast;
                                        break
                                    case 2:
                                		tempLabel.textContent = "Initials";	
                                		tempElement.value = dataInitials;
                                        tempElement.placeHolder = dataInitials;
                                        break
                                    case 3:
                                		tempLabel.textContent = "Employee Id #";	
                                		tempElement.value = dataID;
                                        tempElement.placeHolder = dataID;
                                        break
                                    case 4:
                                		tempLabel.textContent = "Cell #";	
                                		tempElement.value = dataCell;
                                        tempElement.placeHolder = dataCell;
                                        break
                                    case 5:
                                		tempLabel.textContent = "Contact #";	
                                		tempElement.value = dataContact;
                                        tempElement.placeHolder = dataContact;
                                        break
                                    case 6:
                                		tempLabel.textContent = "Company";	
                                		tempElement.value = dataCompany;
                                        tempElement.placeHolder = dataCompany;
                                        break
                                }
                                tempElement.readOnly = "true";
                                tempElement.id = "performed-element-" + i;
                                tempElement.className = "form-control";
                                dataView.append(tempLabel);
                                dataView.append(tempElement);
                            }
                            var classLabel = document.createElement("h5");
                            // Checkbox for Journeyman
                            var journeymanLabel = document.createElement("label");
                            var journeymanElement = document.createElement("input");
                            var journeymanDescription = document.createTextNode("Journeyman");
                            classLabel.textContent = "Class";
                            journeymanElement.type = "checkbox";
                            journeymanElement.className = "control-label";	
                            journeymanElement.value = dataJourneyman;
                            journeymanElement.readonly = "true";
                            journeymanElement.id = "performed-element-7";
                            journeymanLabel.className = "checkbox-inline";
                            journeymanLabel.textContent = "Journey Man";
                            journeymanLabel.append(journeymanElement);
                            journeymanLabel.append(journeymanDescription);
                            dataView.append(classLabel);
                            dataView.append(journeymanLabel);
                            // Checkbox for apprentice
                            var apprenticeLabel = document.createElement("label");
                            var apprenticeElement = document.createElement("input");
                            var apprenticeDescription = document.createTextNode("Apprentice");
                            apprenticeElement.type = "checkbox";
                            apprenticeElement.className = "control-label";	
                            apprenticeElement.value = dataJourneyman;
                            apprenticeElement.readonly = "true";
                            apprenticeElement.id = "performed-element-8";
                            apprenticeLabel.className = "checkbox";
                            apprenticeLabel.append(apprenticeElement);
                            apprenticeLabel.append(apprenticeDescription);
                            dataView.append(apprenticeLabel);
                            // Input field for step
                            var stepLabel = document.createElement("h5");
                            var stepElement = document.createElement("input");
                            stepLabel.textContent = "Step";	
                            stepElement.value = dataStep;
                            stepElement.placeHolder = dataStep;
                            stepElement.readOnly = "true";
                            stepElement.id = "performed-element-9";
                            stepElement.className = "form-control";
                            dataView.append(stepLabel);
                            dataView.append(stepElement);
                            }
                        console.log(childSnapshot.val().nameFull);
                        dataList.appendChild(listEmployee);
                    });
                });
        }
        </script>
        <!-- jQuery -->         
        <script src="../vendor/jquery/jquery.min.js"></script>         
        <!-- Bootstrap Core JavaScript -->         
        <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>         
        <!-- Metis Menu Plugin JavaScript -->         
        <script src="../vendor/metisMenu/metisMenu.min.js"></script>         
        <!-- Custom Theme JavaScript -->         
        <script src="../dist/js/sb-admin-2.js"></script>         
    </body>     
</html>
