<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <meta name="description" content=""> 
        <meta name="author" content=""> 
        <title>BCS Webapp Signup</title>         
        <!-- Bootstrap Core CSS -->         
        <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"> 
        <!-- MetisMenu CSS -->         
        <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet"> 
        <!-- Custom CSS -->         
        <link href="../dist/css/sb-admin-2.css" rel="stylesheet"> 
        <!-- Custom Fonts -->         
        <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"> 
        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->         
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->         
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->         
    </head>     
    <body> 
        <div class="container"> 
            <div class="row"> 
                <h2 class="text-center bg-primary" id="welcome_banner">WELCOME <br>to the BCS Webapp!<br></h2> 
                <div class="col-md-4 col-md-offset-4"> 
                    <div class="login-panel panel panel-default"> 
                        <div class="panel-heading"> 
                            <h3 class="panel-title"><h4>Please provide the information below for a new employee!</h4></h3> 
                        </div>                         
                        <div class="panel-body"> 
                            <form role="form"> 
                                <fieldset> 
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="E-mail" name="email" type="email" autofocus id="email"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="First Name" name="name-first" type="text" value="" id="name-first"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="Last Name" name="name-last" type="text" value="" id="name-last"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" name="password" type="text" value="" id="name-initials" placeholder="Initials ex: EL"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="ID #" name="employee-id" type="number" value="" id="id-num"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="Cell Phone #" name="number-cellular" type="tel" value=""> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="Company (BCS/AKAMAI)" name="company" type="text" value=""> 
                                    </div>                                     
                                    <div> 
                                        <label id="journeyman" class="checkbox-inline"> 
                                            <input class="control-label" type="checkbox" value="">        Journeyman
                                        </label>                                         
                                        <label id="apprentice" class="checkbox-inline"> 
                                            <input class="control-label" type="checkbox" value="">        Apprentice
                                        </label>                                         
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="Step (Enter 0 for none)" name="company" type="number" value id="apprentice-step"> 
                                    </div>                                     
                                    <div class="form-group"> 
                                        <input class="form-control" placeholder="Password" name="password" type="password" value="" id="password"> 
                                    </div>                                     
                                    <!-- Change this to a button or input when using this as a form -->                                     
                                    <p class="btn btn-lg btn-success btn-block" id="create-employee-button" onclick="createEmployee()">Create New Employee</p> 
                                </fieldset>                                 
                            </form>                             
                            <a href="login.html"><h5 class="text-center">Back to Login</h5></a> 
                        </div>                         
                    </div>                     
                </div>                 
            </div>             
        </div>         
        <!-- jQuery -->         
        <script src="../vendor/jquery/jquery.min.js"></script>         
        <!-- Bootstrap Core JavaScript -->         
        <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>         
        <!-- Metis Menu Plugin JavaScript -->         
        <script src="../vendor/metisMenu/metisMenu.min.js"></script>         
        <!-- Custom Theme JavaScript -->         
        <script src="../dist/js/sb-admin-2.js"></script>         
        <!-- Firebase Initialization -->         
        <script src="https://www.gstatic.com/firebasejs/3.7.0/firebase.js"></script>         
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyA55RJ8kvG-n-UClBQSNjnjLK3dvb1vwd8",
                authDomain: "bcs-webapp.firebaseapp.com",
                databaseURL: "https://bcs-webapp.firebaseio.com",
                storageBucket: "bcs-webapp.appspot.com",
                messagingSenderId: "664106049370"
            };
            firebase.initializeApp(config);
        </script>         
        <!-- Firebase Create User -->         
        <script>
        function createEmployee() {
            firebase.auth().createUserWithEmailAndPassword(email.value, password.value).catch(function(error) {
                // Handle Errors here
                var errorCode = error.code;
                var errorMessage = error.message;
                // ...
                alert("The following error occured: " + errorMessage);
            });
            // Send User to index when logged in
            firebase.auth().onAuthStateChanged(user => {
              if(user) {
				// Set var for commonly used details
                var userId = firebase.auth().currentUser.uid;
              	var email = document.getElementById("email").value;
                var nameFirst = document.getElementById("name-first").value;
                var nameLast = document.getElementById("name-last").value;
                var nameFull = nameFirst + " " + nameLast;
                var idNum = document.getElementById("id-num").value;
                console.log("Email: " + email + "\nName: " + nameFull + "\nUID: " + userId);
                firebase.auth().currentUser.updateProfile({displayName: nameFull}).then(function() {console.log("Updated displayName: " + user.displayName)});
                firebase.database().ref().child('/employees/employed/' + idNum).set({
               		username: nameFull,
                    email: email,
                    userId: userId,
                    idNum: idNum
				});
                window.location = 'index.html';
              }
            });
        }
        </script>         
    </body>     
</html>